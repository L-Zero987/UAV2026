参考25赛季无人机代码shoot
# 主要状态以及状态说明

![fire](https://gitee.com/lzero123/typora_-img/raw/master/PicGo/fire.png)

![image-20250826214631744](https://gitee.com/lzero123/typora_-img/raw/master/PicGo/image-20250826214631744.png)

```c
typedef enum
    {
        Disable    = 0x00, // 失能
        Enable     = 0x01, // 使能
        Ready      = 0x02, // 摩擦轮转动，允许播弹盘
        OneShoot   = 0x03, // 单发逻辑
        StartShoot = 0x04, // 连发逻辑
        Stuck      = 0x05, // 卡弹
    } Firc_State_e;
```

Disable:
	进入状态：摩擦轮、拨弹盘参数设0
			  计时器清0
	状态循环：计时器未到指定时间，摩擦轮、拨弹盘(速控)使能
			  计时器未到指定时间，计时器计时
			  计时器到指定时间，摩擦轮、拨弹盘失能
			  检测 拨杆 拨中/上拨 是否进入Enable状态
	退出状态：无

Enable：
	进入状态：棘轮居中标志位置0，用于防止重复跳状态
			  摩擦轮给速度0，拨弹盘给0
	状态循环：摩擦轮、拨弹盘使能
			  检测 拨杆 下拨 是否进入Disable状态
			  棘轮居中标志位为0 检测 棘轮 居中 居中标志位置1
			  棘轮居中标志位为1 检测 棘轮 上拨一点 是否进入Ready状态
			  检测 棘轮 上拨到底 是:拨弹盘反转给速度（退弹） 否:拨弹盘速度给0
	退出状态：无

Ready：
	进入状态：棘轮居中标志位置0，用于防止重复跳状态
			  拨弹盘给0
	状态循环：摩擦轮给指定速度
			  摩擦轮、拨弹盘使能
			  检测 拨杆 下拨 是否进入Disable状态
			  棘轮居中标志位为0 检测 棘轮 居中 居中标志位置1
			  棘轮居中标志位为1 检测 棘轮 上拨一点 是否进入Enable状态
			  检测 棘轮 上拨到底 是:拨弹盘反转给速度（退弹） 否:拨弹盘速度给0
			  检测 棘轮 下拨 拨杆 居中 是否进入OneShoot状态
			  检测 棘轮 下拨 拨杆 上拨 是否进入StartShoot状态
	退出状态：无

OneShoot：
	进入状态：清空计时器
	状态循环：摩擦轮给指定速度
			  摩擦轮、拨弹盘使能
			  检测 调用卡弹检测函数 是否进入Stuck状态
			  检测 拨杆 下拨 是否进入Disable状态
			  计时器没到单发时长，计时器计时
			  计时器没到单发时长，调用发射函数
			  计时器到单发时长，检测 棘轮 居中以上 进入Ready状态
	退出状态：无

StartShoot：
	进入状态：无
	状态循环：摩擦轮给指定速度
			  摩擦轮、拨弹盘使能
			  调用发射函数
			  检测 调用卡弹检测函数 是否进入Stuck状态
			  检测 拨杆 下拨 是否进入Disable状态
			  检测 棘轮 居中以上 进入Ready状态
	退出状态：无

Stuck：
	进入状态：清空计时器
	状态循环：摩擦轮给指定速度
			  摩擦轮、拨弹盘使能
			  计时器没到回退时长，计时器计时
			  计时器没到回退时长，拨弹盘反转
			  计时器到回退时长，进入Ready状态